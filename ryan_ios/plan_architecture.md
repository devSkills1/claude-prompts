# iOS 架构规划

> iOS 架构 / 模块设计 / 大改前必用

【项目背景】
- App 类型：
- 是否已上线：
- 模块范围：
- 最低 iOS 版本：

【当前问题】
- 具体问题：
- 影响范围：
- 是否线上问题：

【模块依赖】
- 上游依赖模块：
- 下游被依赖模块：
- 循环依赖风险：
- 第三方库依赖：

【性能基线】（当前数据，用于对比改动后的影响）
- 启动耗时（冷启 / 热启）：
- 首屏渲染耗时：
- 内存占用（峰值 / 平均）：
- 包体积：
- 核心路径响应时间：

【目标分级】
P0（绝不能出问题）：
P1（明确收益）：
P2（可选优化）：

【成功指标】（可量化的验收标准）
- 功能指标：
- 性能指标：
- 质量指标（崩溃率、测试覆盖率）：
- 监控告警配置：

【强约束】
- 不使用私有 API
- 不改变对外行为
- 不影响启动耗时（< +50ms）
- 不引入新三方库
- 不破坏单元测试覆盖率

【请输出】
1. 当前架构风险点（技术债、性能瓶颈、维护性问题）
2. 可选方案对比（含 Why / Why not / 风险评估）
3. 推荐主方案（技术选型 + 架构图 + 关键设计）
4. 最小可执行拆分步骤（每步独立可验证）
5. 每一步验证方式（单元测试 / 集成测试 / 手工验证）
6. 回滚策略（Git 分支策略 + 功能开关 + 数据迁移）
7. 性能影响评估（对比基线数据）
8. 风险与缓解措施（潜在问题 + 应对方案）

【规则】
- 只分析，不写代码
- 偏保守方案优先
- 每步可验证、可回滚
- 优先考虑渐进式改造而非推倒重来

【相关文档】
- 执行时使用：`code_execute_step.md`
- 审核时使用：`review_and_rollback.md`